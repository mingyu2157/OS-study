# Chapter10 프로세스와 스레드

**프로세스** : 실행중인 프로세스

보조기억장치에 저장된 프로그램을 메모리에 적재하고 실행하는 순간 프로세스가 됨 -> 프로세스 생성

- 포그라운드 프로세스 : 사용자가 보는 앞에서 실행되는 프로세스
- 백그라운드 프로세스 : 사용자가보지 못하는 뒤 편에서 실행되는 프로세스
  - 데몬 : 유닉스 운영체제에서의 사용자와 상호작용하지 않는 백그라운드 프로세스
  - 서비스 : 윈도우 운영체제에서의 사용자와 상호작용하지 않는 백그라운드 프로세스

**프로세스 제어 블록(PCB)** : 프로세스와 관련된 정보를 저장하는 자료구조 (메모리의 커널 영역에 저장됨)

PCB에 담기는 정보

- 프로세스 ID(PID) : 특정 프로세스를 식별하기 위해 부여하는 고유한 번호
- 레지스터 값
- 프로세스 상태
- CPU 스케줄링 정보
- 메모리 관리 정보
- 사용한 파일과 입출력 장치 폭죽

**문맥 교환**

- 문맥 : 하나의 프로세스 수행을 재개하기 위해 기억해야 할 정보
- 문맥 교환 : 기준 프로세스의 문맥을 PCB에 백업하고, 새로운 프로세스를 실행하기 위해 문맥을 PCB로부터 복구하여 새로운 프로세스를 실행하는 것

**프로세스의 메모리 영역**

사용자 영역

1. 코드 영역 (텍스트 영역) : 기계어로 이루어진 명령어가 저장됨(쓰기가 금지) -> 읽기 전용 공간 - 정적 할당 영역
2. 데이터 영역 : 프로그램이 실행되는 동안 유지할 데이터가 저장됨(ex 전역변수) - 정적 할당 영역
3. 힙 영역 : 프로그래머가 직접 할당할 수 있는 저장공간 - 언젠가 반환해야 함 (메모리 누수) - 동적 할당 영역
4. 스택 영역 : 데이터를 일시적으로 저장하는 공간 (ex 지역변수) - 동적 할당 영역

## 프로세스 상태와 계층 구조

프로세스가 가질 수 있는 대표적인 상태

- 생성상태(new) : 프로세스를 생성중인 상태(메모리에 적재되어 PCB를 할당받은 상태)
- 준비상태(ready) : 자신의 차례를 기다리는 상태  --> 디스패치
- 실행상태(running) : CPU를 할당받아 실행중인 상태(타이머 인터럽트 -> 준비상태/입출력 장치 사용 -> 대기상태)
- 대기상태(blocked) : 입출력 장치의 작업을 기다리는 상태
- 종료상태(terminated) : 프로세스가 종료된 상태 -> 운영체제는 PCB와 프로세스가 사용한 메모리 정리

**프로세스 계층 구조** - 프로세스는 실행 도중 시스템 호출을 통해 다른 프로세스를 생성할 수 있음

- 부모 프로세스 : 새 프로세스를 생성한 프로세스
- 자식 프로세스 : 부모 프로세스에 의해 생성된 프로세스 (부모와 다른 PID를 가짐)

**프로세스 생성 기법** - 부모 프로세스를 통해 생성된 자식 프로세스들은 복제(fork)와 옷갈아입기(exec)를 통해 실행됨

- 부모 프로세스는 fork를 통해 자신의 복사본을 자식 프로세스로 생성

  fork : 자기 자신 프로세스의 복사본을 만드는 시스템 호출

- 만들어진 복사본(자식 프로세스)는 exec를 통해 자신의 메모리 공간을 다른 프로그램으로 교체

  exec : 자신의 메모리 공간을 새로운 프로그램으로 덮어쓰는 시스템 호출

## 스레드 

**스레드** : 프로세스를 구성하는 실행의 흐름 단위

- 단일 스레드 프로세스 : 실행의 흐름 단위가 하나인 프로세스
- 멀티 프로세스 : 여러 프로세스를 동시에 실행하는 것
- 멀티 스레드 : 여러 스레드로 프로세스를 동시에 실행하는 것

*스레드 끼리는 프로세스 내의 자원을 공유함